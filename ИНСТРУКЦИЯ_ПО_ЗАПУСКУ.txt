╔══════════════════════════════════════════════════════════════════════════════╗
║                   🎯 ПРОФЕССИОНАЛЬНЫЙ BI DASHBOARD                           ║
║                         ПОЛНАЯ ИНСТРУКЦИЯ                                    ║
╚══════════════════════════════════════════════════════════════════════════════╝

✨ ЧТО СОЗДАНО:

Полноценный BI дашборд по образцу ваших скриншотов с улучшениями:
   ✓ Красивые спидометры (gauge charts) для KPI
   ✓ Детальная таблица с разбивкой по контрактам
   ✓ Графики трендов продаж и затрат
   ✓ Структура затрат (круговая диаграмма)
   ✓ ТОП-10 контрактов
   ✓ Динамика выполнения плана
   ✓ Полная фильтрация по всем параметрам

════════════════════════════════════════════════════════════════════════════════
🚀 БЫСТРЫЙ СТАРТ
════════════════════════════════════════════════════════════════════════════════

СПОСОБ 1 (самый простой - для Windows):
   1. Двойной клик на файл ЗАПУСК.bat
   2. Откроется окно командной строки
   3. Дождитесь сообщения "СЕРВЕР ЗАПУЩЕН"
   4. Откройте браузер: http://localhost:8050

СПОСОБ 2 (через командную строку):
   1. Откройте cmd или PowerShell
   2. Перейдите в папку: cd путь\к\папке
   3. Выполните: python professional_bi_dashboard.py
   4. Откройте браузер: http://localhost:8050

════════════════════════════════════════════════════════════════════════════════
⚙️ НАСТРОЙКА ПУТИ К ДАННЫМ
════════════════════════════════════════════════════════════════════════════════

ВАЖНО! Перед первым запуском укажите путь к вашему файлу:

1. Откройте файл: professional_bi_dashboard.py

2. Найдите строку 26:
   DATA_PATH = r'/workspace/data.xlsx'

3. Замените на ваш путь:
   DATA_PATH = r'\\FS\Users\Private\GFD\Public\Трейд-маркетинг\7.Общие документы\Гусев\итог\data.xlsx'

4. Сохраните файл (Ctrl+S)

ПРИМЕРЫ ПУТЕЙ:
   Windows сетевой диск:
   DATA_PATH = r'\\FS\Users\...\data.xlsx'
   
   Windows локальный:
   DATA_PATH = r'C:\Users\Username\Documents\data.xlsx'
   
   С прямыми слэшами:
   DATA_PATH = '//FS/Users/.../data.xlsx'

════════════════════════════════════════════════════════════════════════════════
📊 ВОЗМОЖНОСТИ ДАШБОРДА
════════════════════════════════════════════════════════════════════════════════

🔍 ФИЛЬТРЫ (верхняя панель):
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   📋 Контракт        → Выбор конкретного контракта из 682
   🏪 Сеть            → Фильтр по торговой сети
   🎯 Бренд           → Фильтр по бренду/продукту
   📊 Группа сбыта    → РКК или СПП
   📅 Период          → Выбор диапазона дат
   📆 Месяц           → Быстрый выбор месяца
   🔄 Сбросить        → Вернуть все фильтры в начальное состояние

📈 СПИДОМЕТРЫ (6 штук - как на вашем скриншоте):
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   1️⃣ ROI план        → Плановая рентабельность инвестиций
   2️⃣ ROI факт        → Фактическая рентабельность
   3️⃣ Выполнение шт   → Процент выполнения плана в штуках
   4️⃣ Выполнение руб  → Процент выполнения плана в рублях
   5️⃣ Затраты         → Процент затрат от плана
   6️⃣ Маржа           → Процент маржинальности
   
   Цвета:
   • Зеленый - отлично (>100%)
   • Желтый - норма (80-100%)
   • Красная линия - целевое значение 100%

📊 ГРАФИК "ДИНАМИКА ПРОДАЖ И ЗАТРАТ":
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   Верхняя часть:
   • Голубая заливка - план продаж
   • Синяя заливка - факт продаж
   • Видно отклонение факта от плана
   
   Нижняя часть:
   • Оранжевые столбцы - фактические затраты по месяцам

💰 ГРАФИК "СТРУКТУРА ЗАТРАТ":
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   Круговая диаграмма с разбивкой затрат:
   • Листинг/безусловные выплаты
   • Скидка в цене
   • Ретро-бонусы
   • Маркетинг
   • Промо-скидки
   
   Показывает где деньги расходуются больше всего

📋 ДЕТАЛЬНАЯ ТАБЛИЦА:
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   Если НЕ выбран контракт:
   → Таблица ТОП-20 контрактов с показателями
   
   Если ВЫБРАН контракт:
   → Детализация по месяцам для этого контракта
   
   Колонки:
   • План/Факт продаж (₽ и шт)
   • Затраты
   • Доход
   • Выполнение % (зеленый фон)
   • ROI % (желтый фон)

🏆 ГРАФИК "ТОП-10 КОНТРАКТОВ":
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   Горизонтальная диаграмма:
   • Показывает 10 лучших контрактов
   • Цветовая градация по объему продаж
   • Адаптируется под выбранные фильтры

📈 ГРАФИК "ВЫПОЛНЕНИЕ ПЛАНА":
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   • Линейный график с точками
   • Красная пунктирная линия - цель 100%
   • Видно динамику выполнения по месяцам

════════════════════════════════════════════════════════════════════════════════
💡 СЦЕНАРИИ ИСПОЛЬЗОВАНИЯ
════════════════════════════════════════════════════════════════════════════════

СЦЕНАРИЙ 1: Анализ конкретного контракта
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   1. Запустите дашборд
   2. В фильтре "Контракт" выберите нужный
   3. Увидите:
      • Спидометры покажут показатели ТОЛЬКО этого контракта
      • Таблица - разбивка по месяцам
      • Графики - динамика во времени
      • ТОП-10 - лучшие месяцы

СЦЕНАРИЙ 2: Анализ сети
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   1. Выберите сеть в фильтре
   2. Увидите все контракты этой сети
   3. Можете дополнительно выбрать бренд
   4. ТОП-10 покажет лучшие контракты сети

СЦЕНАРИЙ 3: Сравнение периодов
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   1. Выберите период (например, Q1 2024)
   2. Запомните показатели спидометров
   3. Измените период (Q2 2024)
   4. Сравните результаты

СЦЕНАРИЙ 4: Поиск проблемных контрактов
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   1. Оставьте все фильтры в "ALL"
   2. Посмотрите таблицу
   3. Найдите контракты с низким "Выполнение %"
   4. Кликните на контракт для детализации

СЦЕНАРИЙ 5: Анализ затрат
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   1. Выберите контракт или период
   2. Посмотрите круговую диаграмму "Структура затрат"
   3. Определите, куда уходит больше всего денег
   4. Сравните с ROI для оценки эффективности

════════════════════════════════════════════════════════════════════════════════
🎨 ИНТЕРАКТИВНОСТЬ ГРАФИКОВ
════════════════════════════════════════════════════════════════════════════════

Все графики Plotly интерактивные:

🔍 HOVER (наведение мыши):
   → Наведите на любую точку/столбец
   → Появится подсказка с точными значениями

🔎 ZOOM (масштабирование):
   → Выделите область мышью
   → График приблизится
   → Двойной клик - вернуть масштаб

💾 ЭКСПОРТ:
   → Наведите на график
   → Появится панель инструментов
   → Кнопка камеры - сохранить как PNG

📊 ЛЕГЕНДА:
   → Кликните на элемент легенды
   → Скроете/покажете эту серию данных

════════════════════════════════════════════════════════════════════════════════
🔄 АВТОМАТИЧЕСКОЕ ОБНОВЛЕНИЕ
════════════════════════════════════════════════════════════════════════════════

При изменении ЛЮБОГО фильтра:
   ✓ ВСЕ спидометры пересчитываются
   ✓ ВСЕ графики перестраиваются
   ✓ Таблица обновляется
   ✓ ТОП-10 актуализируется
   ✓ Счетчик записей меняется

Это происходит МГНОВЕННО!

════════════════════════════════════════════════════════════════════════════════
⚡ ПРОИЗВОДИТЕЛЬНОСТЬ
════════════════════════════════════════════════════════════════════════════════

Данные: 43,899 записей
   • Загрузка при старте: ~5-10 сек
   • Фильтрация: мгновенно (<1 сек)
   • Обновление графиков: <1 сек

Если медленно:
   ✓ Проверьте RAM (нужно минимум 2GB свободно)
   ✓ Закройте другие программы
   ✓ Используйте Chrome (самый быстрый)

════════════════════════════════════════════════════════════════════════════════
🌐 ДОСТУП С ДРУГИХ КОМПЬЮТЕРОВ
════════════════════════════════════════════════════════════════════════════════

Хотите чтобы коллеги тоже видели дашборд?

1. Узнайте свой IP:
   cmd → ipconfig → IPv4 Address
   Например: 192.168.1.100

2. Убедитесь что сервер запущен на вашем ПК

3. Дайте коллегам ссылку:
   http://192.168.1.100:8050

4. Проверьте:
   ✓ Вы в одной сети
   ✓ Брандмауэр не блокирует порт 8050

════════════════════════════════════════════════════════════════════════════════
🔧 НАСТРОЙКА ПОРТА (если 8050 занят)
════════════════════════════════════════════════════════════════════════════════

Если порт 8050 занят другой программой:

1. Откройте: professional_bi_dashboard.py

2. Найдите последнюю строку:
   app.run(debug=False, host='0.0.0.0', port=8050)

3. Измените 8050 на другой порт:
   app.run(debug=False, host='0.0.0.0', port=8888)

4. Откройте: http://localhost:8888

════════════════════════════════════════════════════════════════════════════════
🛑 ОСТАНОВКА СЕРВЕРА
════════════════════════════════════════════════════════════════════════════════

Чтобы остановить:
   1. Перейдите в окно командной строки
   2. Нажмите Ctrl+C
   3. Подтвердите (Y)

Закрытие браузера НЕ останавливает сервер!

════════════════════════════════════════════════════════════════════════════════
🐛 РЕШЕНИЕ ПРОБЛЕМ
════════════════════════════════════════════════════════════════════════════════

ПРОБЛЕМА: "ModuleNotFoundError: No module named 'dash'"
РЕШЕНИЕ:
   pip install dash dash-bootstrap-components plotly pandas openpyxl

ПРОБЛЕМА: "FileNotFoundError: data.xlsx not found"
РЕШЕНИЕ:
   • Проверьте путь DATA_PATH в коде
   • Используйте r'' для Windows путей
   • Убедитесь что файл существует

ПРОБЛЕМА: "Address already in use"
РЕШЕНИЕ:
   • Порт 8050 занят
   • Измените порт в коде (см. выше)
   • Или найдите и закройте процесс на 8050

ПРОБЛЕМА: Дашборд не открывается
РЕШЕНИЕ:
   • Проверьте что сервер запущен (нет ошибок в консоли)
   • Попробуйте http://127.0.0.1:8050
   • Проверьте брандмауэр

ПРОБЛЕМА: Медленная работа
РЕШЕНИЕ:
   • Первая загрузка может занять 10-20 сек
   • Используйте фильтры для уменьшения данных
   • Добавьте RAM если <4GB

ПРОБЛЕМА: Фильтры не работают
РЕШЕНИЕ:
   • Обновите страницу (F5)
   • Проверьте консоль браузера (F12)
   • Перезапустите сервер

════════════════════════════════════════════════════════════════════════════════
💾 ОБНОВЛЕНИЕ ДАННЫХ
════════════════════════════════════════════════════════════════════════════════

Когда обновили data.xlsx:

   1. Остановите сервер (Ctrl+C)
   2. Запустите заново
   3. Новые данные автоматически загрузятся

Не нужно ничего переделывать!

════════════════════════════════════════════════════════════════════════════════
📊 СРАВНЕНИЕ С АНАЛОГАМИ
════════════════════════════════════════════════════════════════════════════════

vs Power BI:
   ✅ Бесплатно (Power BI Pro платный)
   ✅ Работает локально
   ✅ Полный контроль над кодом
   ✅ Быстрая кастомизация

vs Tableau:
   ✅ Не требует лицензии
   ✅ Легкая установка
   ✅ Python-based (легко расширять)

vs Excel:
   ✅ Веб-интерфейс
   ✅ Автоматическая фильтрация
   ✅ Интерактивные графики
   ✅ Доступ через браузер

vs Ваш текущий отчет:
   ✅ Все то же самое + больше возможностей
   ✅ Работает локально с запуском
   ✅ Обновление данных в реальном времени
   ✅ Красивее и удобнее

════════════════════════════════════════════════════════════════════════════════
🎓 ЧТО МОЖНО ДОБАВИТЬ
════════════════════════════════════════════════════════════════════════════════

Легко расширить:
   ✓ Экспорт таблицы в Excel
   ✓ Отправка отчетов на email
   ✓ Дополнительные графики
   ✓ Несколько страниц дашборда
   ✓ Аутентификацию пользователей
   ✓ Историю изменений
   ✓ Прогнозирование трендов

Весь код у вас - делайте что хотите!

════════════════════════════════════════════════════════════════════════════════
📞 ТЕХПОДДЕРЖКА
════════════════════════════════════════════════════════════════════════════════

Если проблемы:
   1. Проверьте эту инструкцию
   2. Посмотрите ошибки в консоли
   3. Убедитесь в правильности пути к данным
   4. Проверьте установку зависимостей

Все ошибки подробно описываются в консоли!

════════════════════════════════════════════════════════════════════════════════
✅ ИТОГО
════════════════════════════════════════════════════════════════════════════════

СОЗДАНО:
   ✓ Профессиональный BI дашборд
   ✓ 6 спидометров (gauge charts)
   ✓ 5 различных графиков
   ✓ Детальная таблица с данными
   ✓ 7 фильтров для анализа
   ✓ Автоматическое обновление
   ✓ Современный дизайн

ФАЙЛЫ:
   ✓ professional_bi_dashboard.py - основной код
   ✓ ЗАПУСК.bat - быстрый запуск
   ✓ ИНСТРУКЦИЯ_ПО_ЗАПУСКУ.txt - эта инструкция

ЗАПУСК:
   Двойной клик → ЗАПУСК.bat
   ИЛИ
   python professional_bi_dashboard.py

АДРЕС:
   http://localhost:8050

════════════════════════════════════════════════════════════════════════════════

🎯 ГОТОВО К РАБОТЕ!

Запускайте и анализируйте! 📊✨

════════════════════════════════════════════════════════════════════════════════
