╔══════════════════════════════════════════════════════════════════════════════╗
║                   ✅ ИСПРАВЛЕНО! ПРАВИЛЬНЫЙ ЗАПУСК                          ║
╚══════════════════════════════════════════════════════════════════════════════╝

Прошу прощения за ошибки! Все скрипты исправлены и протестированы.

════════════════════════════════════════════════════════════════════════════════
🔧 ЧТО ИСПРАВЛЕНО
════════════════════════════════════════════════════════════════════════════════

✅ Все абсолютные пути (/workspace/) заменены на относительные
✅ Добавлена автоматическая проверка существования файлов
✅ Файлы сохраняются в ту же папку где скрипт
✅ Понятные сообщения об ошибках
✅ Новый bat-файл с полной проверкой: ТЕСТ_И_ЗАПУСК.bat

════════════════════════════════════════════════════════════════════════════════
📁 СТРУКТУРА ФАЙЛОВ
════════════════════════════════════════════════════════════════════════════════

Поместите в ОДНУ папку:

   ваша_папка/
   ├── professional_bi_dashboard.py    ← Главный скрипт
   ├── data.xlsx                       ← Ваш файл данных
   ├── ТЕСТ_И_ЗАПУСК.bat              ← Для запуска (NEW!)
   └── README_ПРАВИЛЬНЫЙ_ЗАПУСК.txt   ← Эта инструкция

ВАЖНО! Файлы должны быть в ОДНОЙ папке!

════════════════════════════════════════════════════════════════════════════════
🚀 СПОСОБЫ ЗАПУСКА
════════════════════════════════════════════════════════════════════════════════

СПОСОБ 1 (рекомендуется) - Автоматический с проверкой:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   1. Двойной клик на файл: ТЕСТ_И_ЗАПУСК.bat
   2. Скрипт автоматически:
      • Проверит Python
      • Проверит библиотеки (установит если нужно)
      • Проверит data.xlsx
      • Запустит сервер
   3. Откройте: http://localhost:8050

СПОСОБ 2 - Вручную через командную строку:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   1. Откройте cmd или PowerShell
   2. Перейдите в папку: cd путь\к\папке
   3. Выполните: python professional_bi_dashboard.py
   4. Откройте: http://localhost:8050

════════════════════════════════════════════════════════════════════════════════
📍 РАСПОЛОЖЕНИЕ ФАЙЛОВ
════════════════════════════════════════════════════════════════════════════════

ВАРИАНТ А: Все в одной папке (РЕКОМЕНДУЕТСЯ)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   C:\Users\Username\Documents\BI_Dashboard\
   ├── professional_bi_dashboard.py
   ├── data.xlsx
   └── ТЕСТ_И_ЗАПУСК.bat

   Просто запустите ТЕСТ_И_ЗАПУСК.bat - всё будет работать!

ВАРИАНТ Б: Файл data.xlsx в другом месте
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   1. Откройте: professional_bi_dashboard.py
   
   2. Найдите строки 23-26:
      # Автоматически ищем data.xlsx в текущей директории
      script_dir = os.path.dirname(os.path.abspath(__file__))
      DATA_PATH = os.path.join(script_dir, 'data.xlsx')
      
      # ЕСЛИ НУЖЕН ДРУГОЙ ПУТЬ - РАСКОММЕНТИРУЙТЕ И УКАЖИТЕ:
      # DATA_PATH = r'\\FS\Users\...\data.xlsx'
   
   3. Раскомментируйте последнюю строку и укажите свой путь:
      DATA_PATH = r'\\FS\Users\Private\GFD\Public\Трейд-маркетинг\7.Общие документы\Гусев\итог\data.xlsx'
   
   4. Сохраните (Ctrl+S) и запустите

════════════════════════════════════════════════════════════════════════════════
🐛 РЕШЕНИЕ ОШИБОК
════════════════════════════════════════════════════════════════════════════════

ОШИБКА: "FileNotFoundError: data.xlsx"
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
ПРИЧИНА: Файл data.xlsx не в той папке

РЕШЕНИЕ:
   1. Скопируйте data.xlsx в папку со скриптами
   2. ИЛИ укажите полный путь в DATA_PATH (см. ВАРИАНТ Б выше)

ОШИБКА: "ModuleNotFoundError: No module named 'dash'"
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
ПРИЧИНА: Библиотеки не установлены

РЕШЕНИЕ:
   pip install dash dash-bootstrap-components plotly pandas openpyxl

ОШИБКА: "Address already in use" или "Port 8050 is already in use"
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
ПРИЧИНА: Порт 8050 занят

РЕШЕНИЕ:
   1. Откройте professional_bi_dashboard.py
   2. В самом конце измените:
      app.run(debug=False, host='0.0.0.0', port=8050)
      на
      app.run(debug=False, host='0.0.0.0', port=8888)
   3. Откройте: http://localhost:8888

ОШИБКА: "python не является внутренней или внешней командой"
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
ПРИЧИНА: Python не установлен или не в PATH

РЕШЕНИЕ:
   1. Установите Python: https://www.python.org/downloads/
   2. При установке поставьте галочку "Add Python to PATH"
   3. Перезапустите компьютер

════════════════════════════════════════════════════════════════════════════════
📊 КУДА СОХРАНЯЮТСЯ ОТЧЕТЫ
════════════════════════════════════════════════════════════════════════════════

Все файлы сохраняются в ТУ ЖЕ ПАПКУ где находится скрипт:

   ваша_папка/
   ├── professional_bi_dashboard.py
   ├── data.xlsx
   ├── bi_dashboard_report.html         ← Создается после запуска bi_dashboard.py
   ├── analytics_report.xlsx            ← Создается после запуска advanced_analytics.py
   └── advanced_analytics_report.html   ← Создается после запуска advanced_analytics.py

════════════════════════════════════════════════════════════════════════════════
✅ ПРОВЕРКА ПЕРЕД ЗАПУСКОМ
════════════════════════════════════════════════════════════════════════════════

Убедитесь что:

   □ Python установлен (python --version в cmd)
   □ Библиотеки установлены (или запустите ТЕСТ_И_ЗАПУСК.bat - установит сам)
   □ Файл data.xlsx в правильном месте
   □ Все скрипты в одной папке

════════════════════════════════════════════════════════════════════════════════
🎯 КАКОЙ СКРИПТ ЗАПУСКАТЬ
════════════════════════════════════════════════════════════════════════════════

professional_bi_dashboard.py
   → Полноценный веб-сервер с фильтрами, спидометрами, графиками
   → Открывается в браузере
   → РЕКОМЕНДУЕТСЯ!

bi_dashboard.py
   → Создает HTML файл (не сервер)
   → Просто открываете созданный HTML

advanced_analytics.py
   → Создает Excel + HTML с расширенной аналитикой
   → Дополнительные графики

════════════════════════════════════════════════════════════════════════════════
💡 БЫСТРАЯ ШПАРГАЛКА
════════════════════════════════════════════════════════════════════════════════

Хочу просто запустить:
   → Двойной клик на ТЕСТ_И_ЗАПУСК.bat

Хочу указать свой путь к data.xlsx:
   → Открыть professional_bi_dashboard.py
   → Строки 23-30, раскомментировать и указать путь

Хочу другой порт (не 8050):
   → Открыть professional_bi_dashboard.py
   → Последняя строка, изменить 8050 на другой

Хочу остановить сервер:
   → В окне cmd нажать Ctrl+C

════════════════════════════════════════════════════════════════════════════════
📞 ВСЕ ЕЩЕ НЕ РАБОТАЕТ?
════════════════════════════════════════════════════════════════════════════════

1. Запустите ТЕСТ_И_ЗАПУСК.bat - он покажет где проблема
2. Прочитайте сообщение об ошибке в консоли
3. Проверьте что data.xlsx точно существует
4. Убедитесь что путь правильный (используйте r'' для Windows путей)

════════════════════════════════════════════════════════════════════════════════

✅ Теперь всё должно работать правильно!

Запускайте и анализируйте! 🚀📊

════════════════════════════════════════════════════════════════════════════════
