@echo off
chcp 65001 >nul
title BI Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° - ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€ Ð·Ð°Ð¿ÑƒÑÐºÐ°

:MENU
cls
echo ================================================================================
echo                         BI Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐ - ÐœÐ•ÐÐ•Ð”Ð–Ð•Ð  Ð—ÐÐŸÐ£Ð¡ÐšÐ
echo ================================================================================
echo.
echo   Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ€ÐµÐ¶Ð¸Ð¼ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹:
echo.
echo   1. Ð˜Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð´Ð°ÑˆÐ±Ð¾Ñ€Ð´ - Ð‘Ð°Ð·Ð¾Ð²Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ
echo      - Ð’ÐµÐ±-Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ð½Ð° http://localhost:8050
echo      - ÐžÐ±Ñ‰Ð¸Ðµ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸ Ð¸ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ¸
echo.
echo   2. Ð˜Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð´Ð°ÑˆÐ±Ð¾Ñ€Ð´ - Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ
echo      - Ð’ÐµÐ±-Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ð½Ð° http://localhost:8051
echo      - Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹ Ð¿Ð¾ ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð°Ð¼ Ð¸ SKU
echo      - Ð”ÐµÑ‚Ð°Ð»ÑŒÐ½Ð°Ñ Ñ€Ð°Ð·Ð±Ð¸Ð²ÐºÐ° Ñ€Ð°ÑÑ…Ð¾Ð´Ð¾Ð²
echo      - Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ð´Ð°Ñ‚Ð°Ñ… ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð°
echo.
echo   3. Ð¡Ñ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ HTML Ð¾Ñ‚Ñ‡ÐµÑ‚
echo      - Ð¡Ð¾Ð·Ð´Ð°ÐµÑ‚ Ñ„Ð°Ð¹Ð» bi_report.html
echo      - ÐœÐ¾Ð¶Ð½Ð¾ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð² Ð»ÑŽÐ±Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ
echo      - Ð›ÐµÐ³ÐºÐ¾ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿Ð¾ email
echo.
echo   4. Ð¡Ñ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ HTML + Ð”Ð°ÑˆÐ±Ð¾Ñ€Ð´ (Ð±Ð°Ð·Ð¾Ð²Ñ‹Ð¹)
echo.
echo   5. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ/ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
echo.
echo   0. Ð’Ñ‹Ñ…Ð¾Ð´
echo.
echo ================================================================================
echo.

set /p choice="Ð’Ð°Ñˆ Ð²Ñ‹Ð±Ð¾Ñ€ (0-5): "

if "%choice%"=="1" goto DASHBOARD_BASIC
if "%choice%"=="2" goto DASHBOARD_ADVANCED
if "%choice%"=="3" goto HTML_REPORT
if "%choice%"=="4" goto BOTH
if "%choice%"=="5" goto INSTALL
if "%choice%"=="0" goto EXIT
goto MENU

:INSTALL
echo.
echo ================================================================================
echo ðŸ“¦ Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹...
echo ================================================================================
echo.

python --version >nul 2>&1
if errorlevel 1 (
    echo âŒ Python Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½!
    echo.
    echo ðŸ’¡ Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Python Ñ https://www.python.org/downloads/
    echo    ÐŸÑ€Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¾Ñ‚Ð¼ÐµÑ‚ÑŒÑ‚Ðµ "Add Python to PATH"
    echo.
    pause
    goto MENU
)

echo âœ… Python Ð½Ð°Ð¹Ð´ÐµÐ½
echo.
echo ðŸ“¥ Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð¿Ð°ÐºÐµÑ‚Ð¾Ð²...
echo.

pip install pandas openpyxl plotly dash dash-bootstrap-components numpy -q

if errorlevel 1 (
    echo.
    echo âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐµ!
    pause
    goto MENU
)

echo.
echo âœ… Ð’ÑÐµ Ð¿Ð°ÐºÐµÑ‚Ñ‹ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹!
echo.
pause
goto MENU

:DASHBOARD_BASIC
echo.
echo ================================================================================
echo ðŸš€ Ð—ÐÐŸÐ£Ð¡Ðš Ð”ÐÐ¨Ð‘ÐžÐ Ð”Ð - Ð‘ÐÐ—ÐžÐ’ÐÐ¯ Ð’Ð•Ð Ð¡Ð˜Ð¯
echo ================================================================================
echo.

REM Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð¿ÑƒÑ‚ÑŒ Ðº Ð´Ð°Ð½Ð½Ñ‹Ð¼
set DATA_FILE_PATH=\\FS\Users\Private\GFD\Public\Ð¢Ñ€ÐµÐ¹Ð´-Ð¼Ð°Ñ€ÐºÐµÑ‚Ð¸Ð½Ð³\7.ÐžÐ±Ñ‰Ð¸Ðµ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ñ‹\Ð“ÑƒÑÐµÐ²\Ð¸Ñ‚Ð¾Ð³\data.xlsx

REM Ð•ÑÐ»Ð¸ Ñ„Ð°Ð¹Ð» Ð² ÑÑ‚Ð¾Ð¹ Ð¶Ðµ Ð¿Ð°Ð¿ÐºÐµ
if exist "%~dp0data.xlsx" (
    set DATA_FILE_PATH=%~dp0data.xlsx
)

echo ðŸ“‚ ÐŸÑƒÑ‚ÑŒ Ðº Ð´Ð°Ð½Ð½Ñ‹Ð¼: %DATA_FILE_PATH%
echo.
echo ðŸ“Š Ð—Ð°Ð¿ÑƒÑÐº Ð´Ð°ÑˆÐ±Ð¾Ñ€Ð´Ð°...
echo ðŸ’¡ ÐŸÐ¾ÑÐ»Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ð¾Ñ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Ð² Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ðµ: http://localhost:8050
echo ðŸ’¡ Ð”Ð»Ñ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Ð½Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ Ctrl+C
echo.
echo ================================================================================
echo.

python "%~dp0bi_dashboard.py"

if errorlevel 1 (
    echo.
    echo âŒ ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ°!
    echo.
    pause
)
goto MENU

:DASHBOARD_ADVANCED
echo.
echo ================================================================================
echo ðŸš€ Ð—ÐÐŸÐ£Ð¡Ðš Ð”ÐÐ¨Ð‘ÐžÐ Ð”Ð - Ð ÐÐ¡Ð¨Ð˜Ð Ð•ÐÐÐÐ¯ Ð’Ð•Ð Ð¡Ð˜Ð¯
echo ================================================================================
echo.

REM Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð¿ÑƒÑ‚ÑŒ Ðº Ð´Ð°Ð½Ð½Ñ‹Ð¼
set DATA_FILE_PATH=\\FS\Users\Private\GFD\Public\Ð¢Ñ€ÐµÐ¹Ð´-Ð¼Ð°Ñ€ÐºÐµÑ‚Ð¸Ð½Ð³\7.ÐžÐ±Ñ‰Ð¸Ðµ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ñ‹\Ð“ÑƒÑÐµÐ²\Ð¸Ñ‚Ð¾Ð³\data.xlsx

REM Ð•ÑÐ»Ð¸ Ñ„Ð°Ð¹Ð» Ð² ÑÑ‚Ð¾Ð¹ Ð¶Ðµ Ð¿Ð°Ð¿ÐºÐµ
if exist "%~dp0data.xlsx" (
    set DATA_FILE_PATH=%~dp0data.xlsx
)

echo ðŸ“‚ ÐŸÑƒÑ‚ÑŒ Ðº Ð´Ð°Ð½Ð½Ñ‹Ð¼: %DATA_FILE_PATH%
echo.
echo ðŸ“Š Ð—Ð°Ð¿ÑƒÑÐº Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð´Ð°ÑˆÐ±Ð¾Ñ€Ð´Ð°...
echo ðŸ’¡ ÐŸÐ¾ÑÐ»Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ð¾Ñ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Ð² Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ðµ: http://localhost:8051
echo.
echo âœ¨ ÐÐ¾Ð²Ñ‹Ðµ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸:
echo    - Ð¤Ð¸Ð»ÑŒÑ‚Ñ€ Ð¿Ð¾ ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð°Ð¼, ÑÐµÑ‚ÑÐ¼ Ð¸ SKU
echo    - Ð”Ð°Ñ‚Ñ‹ Ð½Ð°Ñ‡Ð°Ð»Ð° Ð¸ ÐºÐ¾Ð½Ñ†Ð° ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð°
echo    - Ð”ÐµÑ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð²ÑÐµÑ… Ñ€Ð°ÑÑ…Ð¾Ð´Ð¾Ð²
echo    - Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ Ð² Excel
echo.
echo ðŸ’¡ Ð”Ð»Ñ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Ð½Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ Ctrl+C
echo.
echo ================================================================================
echo.

python "%~dp0bi_dashboard_advanced.py"

if errorlevel 1 (
    echo.
    echo âŒ ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ°!
    echo.
    pause
)
goto MENU

:HTML_REPORT
echo.
echo ================================================================================
echo ðŸ“Š Ð“Ð•ÐÐ•Ð ÐÐ¦Ð˜Ð¯ HTML ÐžÐ¢Ð§Ð•Ð¢Ð
echo ================================================================================
echo.

REM Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð¿ÑƒÑ‚ÑŒ Ðº Ð´Ð°Ð½Ð½Ñ‹Ð¼
set DATA_FILE_PATH=\\FS\Users\Private\GFD\Public\Ð¢Ñ€ÐµÐ¹Ð´-Ð¼Ð°Ñ€ÐºÐµÑ‚Ð¸Ð½Ð³\7.ÐžÐ±Ñ‰Ð¸Ðµ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ñ‹\Ð“ÑƒÑÐµÐ²\Ð¸Ñ‚Ð¾Ð³\data.xlsx

if exist "%~dp0data.xlsx" (
    set DATA_FILE_PATH=%~dp0data.xlsx
)

echo ðŸ“‚ ÐŸÑƒÑ‚ÑŒ Ðº Ð´Ð°Ð½Ð½Ñ‹Ð¼: %DATA_FILE_PATH%
echo.

python "%~dp0generate_html_report.py"

if errorlevel 1 (
    echo.
    echo âŒ ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ°!
    pause
    goto MENU
)

echo.
echo ================================================================================
set /p open="ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð¾Ñ‚Ñ‡ÐµÑ‚ Ð² Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ðµ? (y/n): "
if /i "%open%"=="y" (
    start "" "%~dp0bi_report.html"
    echo âœ… ÐžÑ‚Ñ‡ÐµÑ‚ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚!
)
echo.
pause
goto MENU

:BOTH
echo.
echo ================================================================================
echo ðŸ“Š Ð“Ð•ÐÐ•Ð ÐÐ¦Ð˜Ð¯ HTML ÐžÐ¢Ð§Ð•Ð¢Ð
echo ================================================================================
echo.

REM Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð¿ÑƒÑ‚ÑŒ Ðº Ð´Ð°Ð½Ð½Ñ‹Ð¼
set DATA_FILE_PATH=\\FS\Users\Private\GFD\Public\Ð¢Ñ€ÐµÐ¹Ð´-Ð¼Ð°Ñ€ÐºÐµÑ‚Ð¸Ð½Ð³\7.ÐžÐ±Ñ‰Ð¸Ðµ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ñ‹\Ð“ÑƒÑÐµÐ²\Ð¸Ñ‚Ð¾Ð³\data.xlsx

if exist "%~dp0data.xlsx" (
    set DATA_FILE_PATH=%~dp0data.xlsx
)

echo ðŸ“‚ ÐŸÑƒÑ‚ÑŒ Ðº Ð´Ð°Ð½Ð½Ñ‹Ð¼: %DATA_FILE_PATH%
echo.

python "%~dp0generate_html_report.py"

echo.
echo ================================================================================
echo ðŸš€ Ð—ÐÐŸÐ£Ð¡Ðš Ð˜ÐÐ¢Ð•Ð ÐÐšÐ¢Ð˜Ð’ÐÐžÐ“Ðž Ð”ÐÐ¨Ð‘ÐžÐ Ð”Ð
echo ================================================================================
echo.
echo ðŸ“Š Ð—Ð°Ð¿ÑƒÑÐº Ð´Ð°ÑˆÐ±Ð¾Ñ€Ð´Ð°...
echo ðŸ’¡ ÐŸÐ¾ÑÐ»Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ð¾Ñ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Ð² Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ðµ: http://localhost:8050
echo ðŸ’¡ Ð”Ð»Ñ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Ð½Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ Ctrl+C
echo.
echo ================================================================================
echo.

python "%~dp0bi_dashboard.py"

if errorlevel 1 (
    echo.
    echo âŒ ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ°!
    pause
)
goto MENU

:EXIT
echo.
echo ðŸ‘‹ Ð”Ð¾ ÑÐ²Ð¸Ð´Ð°Ð½Ð¸Ñ!
echo.
timeout /t 2 >nul
exit

